---
logging:
  categories: Warning, Error, Debug
test_framework_runtime_config: "--log_level=test_suite"

window_begin: &win_begin 2019-11-26T21:00:00Z
window_end: &win_end 2019-11-27T03:00:00Z

LinearObsOpTest: 
 coefTL: 1.e-5
 toleranceTL: 1.0e-5
 toleranceAD: 1.0e-11

Observations:
  ObsTypes:
  - ObsOperator:
      name: RTTOV
      ObsOptions:
        Sensor_ID: noaa_20_atms
        CoefficientPath: &rttov_coeff Data/
        mw_clw: true
      ExtraVars:
        - mass_content_of_cloud_liquid_water_in_atmosphere_layer
        - mass_content_of_cloud_ice_in_atmosphere_layer
    GeoVaLs:
      filename: Data/atms_allsats_geoval_2019112700-init.nc4
    ObsSpace: 
      name: Radiance
      ObsDataIn:
        obsfile: &obs_file Data/atms_allsats_obs_2019112700-init.nc4
      ObsDataOut: 
        obsfile: Data/atms_allsats_obs_2019112700-out.nc4
      simulate:
        variables: [brightness_temperature]
        channels: &ops_channels 6-22
    ObsFilters:
    - Filter: RTTOV OneDVar Check
#      where:
#      - variable:
#          name: qc_flags@MetaData
#        minvalue: -0.5 # Values of 0 and 1
#        maxvalue:  1.5 # Values of 0 and 1
      applyfilter: 
      - name: post@HofX
      ModName: RTTOV
      ObsOptions:
        Sensor_ID: noaa_20_atms
        CoefficientPath: *rttov_coeff
      variables: [brightness_temperature]
      channels: *ops_channels
      model_variables:
      - air_temperature
      - specific_humidity
      - air_temperature_at_two_meters_above_surface
      - specific_humidity_at_two_meters_above_surface
      - skin_temperature
      - surface_air_pressure
      BMatrix: Data/atms_bmatrix_70.dat
      nlevels: 70
      rtype: diagonal # diagonal or full R matrix
      qtotal: true
      RTTOV_mwscattSwitch: false
      UseMLMinimization: false
      UseJforConvergence: true
      FullDiagnostics: true
      JConvergenceOption: 0
      ConvergenceFactor: 0.40
      Cost_ConvergenceFactor: 0.01
      Max1DVarIterations: 7
    rmsequiv: 239.48475677393529
    tolerance: 1.e-10
    passedBenchmark: 1649      # number of passed obs
